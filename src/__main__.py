from src.vqe_runner import VQERunner
from src.molecules import *
from src.ansatz_element_lists import *
from src.backends import QiskitSimulation
from src.utils import LogUtils

import logging
import time
import numpy
import pandas
import datetime
import qiskit


# HF UCCSD
# var_parameters = [-8.21930763e-05, -1.18016849e-04, -7.98497167e-05, -1.20558130e-04,
#                      -2.71828500e-03, -5.52887296e-05, -4.24819306e-05, -2.73173964e-03,
#                      -1.24402115e-02, -4.20750089e-05, -3.21141042e-05, -1.24511237e-02,
#                      -4.54559184e-05, -2.55549825e-05, -4.42484180e-05, -2.61868262e-05,
#                      -4.54615087e-05, -2.55497799e-05, -4.42561363e-05, -2.61781939e-05,
#                       2.83893140e-04, -4.37068230e-05, -4.77985128e-04, -8.56411152e-05,
#                      -1.14519633e-04, -5.43056935e-05, -5.43335983e-05, -5.43052205e-05,
#                      -5.43337150e-05 , 4.83408784e-04, -5.06900520e-05,  1.44593276e-06,
#                      -2.71889003e-05, -5.43728740e-05, -5.42843153e-05, -5.43740026e-05,
#                      -5.42840143e-05,  2.41929395e-02, -5.29960230e-05, -2.91286495e-02,
#                      -4.49751624e-05, -5.06522195e-05, -4.49752961e-05, -5.06526232e-05,
#                       2.90414096e-02, -4.22846695e-05, -4.74649165e-05, -4.42913892e-05,
#                      -4.74643183e-05, -4.42908121e-05,  1.35451655e-01, -4.29996748e-05,
#                      -4.35698326e-05, -4.29991005e-05, -4.35698876e-05, -5.36927698e-05,
#                      -5.12717227e-05, -5.36926375e-05, -5.12717375e-05,  1.79177587e-02,
#                      -5.03556900e-05, -5.28622303e-05, -5.28628691e-05, -5.03548319e-05,
#                       1.79208097e-02]

# H2O uccsd
initial_var_parameters =  [-3.70756490e-04,-3.70219777e-04,-3.71689325e-04,-3.71327002e-04,-3.70219830e-04,-3.70756542e-04,
                           -3.71327002e-04,-3.71689325e-04,-2.37076976e-05,-2.18596498e-05,-2.47231508e-05,-2.35375699e-05,
                           -2.18597550e-05,-2.37078029e-05,-2.35375699e-05,-2.47231508e-05,-1.15156845e-05,-1.02593749e-05,
                           -1.43004343e-05,-1.13696240e-05,-1.02594801e-05,-1.15158160e-05,-1.13695714e-05,-1.43003817e-05,
                           -1.01221785e-05,-8.50543911e-06,-1.08821770e-05,-9.53851523e-06,-8.50543911e-06,-1.01221785e-05,
                           -9.53851523e-06,-1.08821770e-05,-7.19886453e-06,-6.52287776e-06,-8.28452032e-06,-7.83915815e-06,
                           -6.52298298e-06,-7.19899605e-06,-7.83921075e-06,-8.28459923e-06,9.92410853e-03,-8.08109618e-04,
                           -8.10158542e-04,-8.10158594e-04,-8.08109618e-04,6.43567339e-03,-3.96823118e-04,-3.96740027e-04,
                           -3.97240941e-04,-3.96404217e-04,-3.92807231e-04,-3.98278910e-04,-3.94487260e-03,-3.94804390e-04,
                           -3.97676492e-04,-3.98164571e-04,-3.96938825e-04,-7.06529962e-03,-3.82292875e-04,3.43739056e-03,
                           -3.82143079e-04,-3.83643296e-04,-3.78301107e-04,-3.84950134e-04,-3.82498748e-04,-3.79406096e-04,
                           2.04728366e-03,1.10729596e-03,-3.82694153e-04,-3.85156113e-04,-3.84001622e-04,-3.83431978e-04,
                           -3.83774785e-04,-3.83327450e-04,-3.79572488e-04,-3.84557352e-04,-1.20753179e-03,-3.80956052e-04,
                           -3.83986445e-04,-3.84085081e-04,-3.83017338e-04,-4.93082721e-03,-3.83279552e-04,-3.82094524e-04,
                           -3.83335736e-04,-3.82930643e-04,-3.80074034e-04,-3.84443723e-04,-3.83760687e-04,-3.81454336e-04,
                           -3.83586350e-04,-3.83642639e-04,-3.81676675e-04,-3.84924988e-04,3.14903067e-03,-3.96938930e-04,
                           -3.98164571e-04,-3.97676440e-04,-3.94804285e-04,6.26654627e-03,-3.96823066e-04,-3.92807283e-04,
                           -3.96404217e-04,-3.97241046e-04,-3.96739975e-04,-3.98278752e-04,-3.82498801e-04,-3.82694206e-04,
                           1.00729596e-03,2.04728364e-03,-3.79406043e-04,-3.85156113e-04,-3.82292822e-04,-3.78301107e-04,
                           -3.83643296e-04,-3.82143079e-04,3.43739035e-03,-3.84950187e-04,4.38559488e-04,-3.83017338e-04,
                           -3.84084924e-04,-3.83986340e-04,-3.80956052e-04,4.16074364e-03,-3.84001675e-04,-3.79572488e-04,
                           -3.83327503e-04,-3.83774890e-04,-3.83431926e-04,-3.84557352e-04,-3.83760634e-04,-3.81676675e-04,
                           -3.83642639e-04,-3.83586298e-04,-3.81454493e-04,-3.84924988e-04,-3.83279395e-04,-3.80074034e-04,
                           -3.82930748e-04,-3.83335788e-04,-3.82094524e-04,-3.84443775e-04,3.69115268e-02,-4.75301552e-05,
                           -4.95790527e-05,-4.95790527e-05,-4.75300500e-05,2.36602101e-02,-3.36942580e-05,1.41621887e-02,
                           -3.41151321e-05,-3.51272184e-05,-2.89618771e-05,-3.70047782e-05,-3.62374149e-05,-3.45386628e-05,
                           2.65993525e-02,-1.24753100e-02,-3.56922855e-05,-3.95480666e-05,-3.32727526e-05,-3.40968252e-05,
                           -3.36165326e-05,-3.26811195e-05,-2.81027953e-05,-3.44816379e-05,-2.18378154e-02,-3.34860172e-05,
                           -3.56930482e-05,-3.53036588e-05,-3.34127371e-05,5.81677592e-03,-3.08616367e-05,-3.10705876e-05,
                           -3.14886736e-05,-3.05954504e-05,-2.69157678e-05,-3.26791731e-05,-3.35758682e-05,-3.26634176e-05,
                           -3.39722016e-05,-3.35404907e-05,-3.07511641e-05,-3.53934046e-05,-3.62374149e-05,-3.56922329e-05,
                           -1.24753100e-02,2.65993525e-02,-3.45386628e-05,-3.95480666e-05,-3.36942580e-05,-2.89617719e-05,
                           -3.51272184e-05,-3.41150794e-05,1.41621887e-02,-3.70047782e-05,2.17665709e-02,-3.34127897e-05,
                           -3.53036062e-05,-3.56930482e-05,-3.34860172e-05,-5.89043809e-03,-3.32727526e-05,-2.81028479e-05,
                           -3.26810669e-05,-3.36165852e-05,-3.40968252e-05,-3.44817431e-05,-3.35759471e-05,-3.07513219e-05,
                           -3.35403329e-05,-3.39721490e-05,-3.26634702e-05,-3.53933520e-05,-3.08615841e-05,-2.69156626e-05,-3.05955557e-05,-3.14885684e-05,-3.10705876e-05,-3.26791205e-05,2.51017478e-02,-2.40705737e-05,-2.61195763e-05,-2.61195237e-05,-2.40705737e-05,5.85881502e-02,-2.18410799e-05,1.68027565e-02,-2.16172414e-05,-2.30187698e-05,-1.66952687e-05,-2.42515908e-05,-2.28053737e-05,-2.18467087e-05,-1.78793545e-02,3.46593894e-02,-2.06198848e-05,-2.52158846e-05,-1.93216219e-05,-2.07080524e-05,-1.93808300e-05,-2.08246272e-05,-1.53995046e-05,-2.23406525e-05,-1.98390806e-05,-2.01042936e-05,-1.96677693e-05,-2.15729209e-05,-1.70384701e-05,-2.28582427e-05,-2.28054000e-05,-2.06198848e-05,3.46593892e-02,-1.78793545e-02,-2.18467087e-05,-2.52158320e-05,-2.18411588e-05,-1.66952687e-05,-2.30187698e-05,-2.16172414e-05,1.68027564e-02,-2.42516434e-05,-1.98390806e-05,-1.70384175e-05,-2.15729209e-05,-1.96677166e-05,-2.01042936e-05,-2.28582953e-05,-1.93214904e-05,-1.53994520e-05,-2.08246798e-05,-1.93807774e-05,-2.07080524e-05,-2.23406525e-05,3.23092633e-02,-2.18097793e-05,-2.38585979e-05,-2.38585979e-05,-2.18096215e-05,2.68487576e-02,-1.93026575e-05,-1.90250295e-05,-1.92849556e-05,-1.87812534e-05,-1.49433056e-05,-2.02202109e-05,-2.02829698e-05,-1.88838876e-05,-2.00345644e-05,-1.99921114e-05,-1.70449406e-05,-2.12005758e-05,-2.02829435e-05,-1.70448880e-05,-1.99921640e-05,-2.00345118e-05,-1.88838876e-05,-2.12003654e-05,-1.93027627e-05,-1.49433056e-05,-1.87813060e-05,-1.92850082e-05,-1.90250821e-05,-2.02202109e-05,1.35003040e-02,-1.78641471e-05,-1.99132813e-05,-1.99131761e-05,-1.78641471e-05,8.88566915e-03]


if __name__ == "__main__":

    molecule = H2O
    # r = 0.995
    molecule_params = None

    # logging
    LogUtils.log_cofig()

    uccsd = UCCSD(molecule.n_orbitals, molecule.n_electrons)

    ansatz_elements = uccsd.get_ansatz_elements()

    vqe_runner = VQERunner(molecule, backend=QiskitSimulation, molecule_geometry_params=molecule_params,
                           print_var_parameters=True)
    t0 = time.time()
    result = vqe_runner.vqe_run(ansatz_elements=ansatz_elements, initial_var_parameters=initial_var_parameters)
    t = time.time()

    logging.critical(result)
    print(result)
    print('TIme for running: ', t - t0)

    print('Pizza')


