from src.vqe_runner import VQERunner
from src.molecules import *
from src.ansatz_element_lists import *
from src.backends import QiskitSimulation
from src.utils import LogUtils

import logging
import time
import numpy
import pandas
import datetime
import qiskit


# HF UCCSD
# var_parameters = [-8.21930763e-05, -1.18016849e-04, -7.98497167e-05, -1.20558130e-04,
#                      -2.71828500e-03, -5.52887296e-05, -4.24819306e-05, -2.73173964e-03,
#                      -1.24402115e-02, -4.20750089e-05, -3.21141042e-05, -1.24511237e-02,
#                      -4.54559184e-05, -2.55549825e-05, -4.42484180e-05, -2.61868262e-05,
#                      -4.54615087e-05, -2.55497799e-05, -4.42561363e-05, -2.61781939e-05,
#                       2.83893140e-04, -4.37068230e-05, -4.77985128e-04, -8.56411152e-05,
#                      -1.14519633e-04, -5.43056935e-05, -5.43335983e-05, -5.43052205e-05,
#                      -5.43337150e-05 , 4.83408784e-04, -5.06900520e-05,  1.44593276e-06,
#                      -2.71889003e-05, -5.43728740e-05, -5.42843153e-05, -5.43740026e-05,
#                      -5.42840143e-05,  2.41929395e-02, -5.29960230e-05, -2.91286495e-02,
#                      -4.49751624e-05, -5.06522195e-05, -4.49752961e-05, -5.06526232e-05,
#                       2.90414096e-02, -4.22846695e-05, -4.74649165e-05, -4.42913892e-05,
#                      -4.74643183e-05, -4.42908121e-05,  1.35451655e-01, -4.29996748e-05,
#                      -4.35698326e-05, -4.29991005e-05, -4.35698876e-05, -5.36927698e-05,
#                      -5.12717227e-05, -5.36926375e-05, -5.12717375e-05,  1.79177587e-02,
#                      -5.03556900e-05, -5.28622303e-05, -5.28628691e-05, -5.03548319e-05,
#                       1.79208097e-02]

# H2O uccsd
# initial_var_parameters =   [ 1.28562514e-05  1.49599383e-05  1.58375889e-05  1.82886237e-05
#   1.57627868e-05  1.19085036e-05  1.64315607e-05  1.89266167e-05
#   9.16396202e-05 -3.04996006e-05 -2.79472239e-05 -2.72694670e-05
#  -2.83550647e-05  8.93940900e-05 -3.23328820e-05 -2.73389917e-05
#  -1.43905795e-05 -1.55230651e-05  5.16574112e-04 -1.37224693e-05
#  -1.22796757e-05 -1.46524548e-05 -1.48625761e-05  5.16679053e-04
#  -6.44299668e-04 -1.35093131e-05 -1.40041714e-05 -1.43483301e-05
#  -1.17393094e-05 -6.44977025e-04 -1.40270661e-05 -1.31796588e-05
#  -9.50010822e-06 -9.28473176e-06 -1.05290116e-05 -1.03903150e-05
#  -8.62742334e-06 -1.01102812e-05 -1.00325060e-05 -1.08506808e-05
#  -2.31672359e-04  1.02001530e-05  1.03765119e-05  1.00500711e-05
#   1.00643524e-05 -2.16866484e-04  2.42499922e-05  2.47195010e-05
#   2.38582857e-05  2.43008715e-05  2.30697655e-05  2.44475214e-05
#   2.98368596e-04  2.25458385e-05  2.24989068e-05  2.39478189e-05
#   2.37871410e-05  5.58531905e-04  2.09852773e-05 -2.21865989e-04
#   2.02470420e-05  1.97951303e-05  1.93014606e-05  2.18079621e-05
#   2.01953218e-05  1.96658260e-05 -1.78875220e-04 -4.47677346e-05
#   2.01613472e-05  2.03708803e-05  2.12037905e-05  2.09554200e-05
#   2.01825310e-05  2.09487031e-05  2.01053463e-05  2.07282288e-05
#   1.87607572e-04  2.00360588e-05  2.12735694e-05  1.95022455e-05
#   2.02462649e-05  3.78135507e-04  2.07674293e-05  2.04505595e-05
#   2.03835583e-05  2.01245182e-05  1.97531684e-05  2.10612011e-05
#   2.08077856e-05  2.00092845e-05  2.03220878e-05  2.02366439e-05
#   2.02628796e-05  2.10886516e-05 -2.49965504e-04  2.51865136e-05
#   2.48365084e-05  2.50066261e-05  2.42225375e-05 -5.10061304e-04
#   2.39645168e-05  2.30701839e-05  2.32666067e-05  2.46147675e-05
#   2.45989238e-05  2.38840055e-05  2.10105136e-05  2.01360604e-05
#  -2.46562951e-05 -1.77610729e-04  1.96664621e-05  2.19209961e-05
#   2.02088834e-05  1.93013620e-05  1.93690759e-05  2.06452027e-05
#  -2.22036944e-04  2.03640324e-05 -1.44711708e-04  2.09834846e-05
#   2.03942621e-05  2.12897918e-05  2.06919042e-05 -3.35371428e-04
#   2.16231887e-05  2.01052408e-05  2.14219693e-05  1.97947435e-05
#   2.06744048e-05  2.19817451e-05  2.08447183e-05  2.02635072e-05
#   2.02716078e-05  2.02579297e-05  2.00377183e-05  2.11189026e-05
#   2.08282841e-05  1.97535012e-05  2.01582561e-05  2.03205175e-05
#   2.04796235e-05  2.10905291e-05  3.58493729e-02 -4.68454202e-05
#  -4.76348808e-05 -4.87870435e-05 -4.47351824e-05  2.20702453e-02
#  -3.67800245e-05  1.35204713e-02 -3.76883406e-05 -3.95440288e-05
#  -3.34609197e-05 -4.04386347e-05 -4.07250692e-05 -3.94664956e-05
#   2.81121532e-02 -1.46340169e-02 -3.89403853e-05 -4.25798644e-05
#  -3.59715167e-05 -3.69531023e-05 -3.78537229e-05 -3.57920406e-05
#  -3.18674954e-05 -3.80932906e-05 -2.44705272e-02 -3.71466904e-05
#  -3.79071321e-05 -3.83466716e-05 -3.53804928e-05  5.39231991e-03
#  -3.43642949e-05 -3.51523182e-05 -3.57818075e-05 -3.44353847e-05
#  -3.06581993e-05 -3.58780031e-05 -3.75031796e-05 -3.75484034e-05
#  -3.88133707e-05 -3.76223345e-05 -3.45632832e-05 -3.88613096e-05
#  -3.97895971e-05 -3.96520820e-05 -1.46417658e-02  2.81148204e-02
#  -3.94531848e-05 -4.41844461e-05 -3.77675238e-05 -3.34382698e-05
#  -4.02762121e-05 -3.76818507e-05  1.35194113e-02 -3.93746196e-05
#   2.43978794e-02 -3.67803213e-05 -4.10883283e-05 -4.03364777e-05
#  -3.89916353e-05 -5.47385919e-03 -3.56235725e-05 -3.18555669e-05
#  -3.61254278e-05 -3.70623914e-05 -3.68971065e-05 -3.71676972e-05
#  -3.65319834e-05 -3.45579881e-05 -3.84966965e-05 -3.81826969e-05
#  -3.72961636e-05 -3.92644341e-05 -3.36262409e-05 -3.06485209e-05
#  -3.52909569e-05 -3.51683918e-05 -3.48919195e-05  6.37350802e-05
#   2.93377924e-02 -2.65348979e-05 -3.04493268e-05 -3.03663178e-05
#  -2.68303103e-05  6.56861883e-02 -2.55634297e-05  1.77898109e-02
#  -2.57563354e-05 -2.62340693e-05 -2.08527044e-05 -2.74947523e-05
#  -2.72810317e-05 -2.51193699e-05 -2.18309826e-02  3.95886465e-02
#  -2.34315318e-05 -2.88745794e-05 -2.33325086e-05 -2.40645249e-05
#  -2.40534315e-05 -2.51159386e-05 -1.94561183e-05 -2.62503664e-05
#  -2.39682077e-05 -2.36641611e-05 -2.45505493e-05 -2.58591350e-05
#  -2.12075646e-05 -2.69322572e-05 -2.66569593e-05 -2.34341286e-05
#   3.95872203e-02 -2.18249893e-02 -2.58435220e-05 -3.02954291e-05
#  -2.49281430e-05 -2.08318699e-05 -2.61444918e-05 -2.49883212e-05
#   1.77958186e-02 -2.85297812e-05 -2.40815695e-05 -2.11917557e-05
#  -2.57060804e-05 -2.41532599e-05 -2.41799870e-05 -2.74722131e-05
#  -2.34616468e-05 -1.94409178e-05 -2.48862579e-05 -2.37452617e-05
#  -2.45967045e-05 -2.69222323e-05  3.71695001e-02 -2.52185617e-05
#  -2.71332730e-05 -2.75243212e-05 -2.34542258e-05  3.08445928e-02
#  -2.30385954e-05 -2.35349503e-05 -2.39646267e-05 -2.37631453e-05
#  -1.87958537e-05 -2.45748124e-05 -2.41648845e-05 -2.36649675e-05
#  -2.49279814e-05 -2.51574570e-05 -2.11039766e-05 -2.57386839e-05
#  -2.53822469e-05 -2.11049762e-05 -2.47624582e-05 -2.50129920e-05
#  -2.39680303e-05 -2.53016888e-05 -2.42053623e-05 -1.87961160e-05
#  -2.33772681e-05 -2.40470757e-05 -2.38434757e-05 -2.41349405e-05
#   1.54629574e-02 -2.01085269e-05 -2.27149786e-05 -2.29367090e-05
#  -2.05133641e-05  9.49884974e-03]

if __name__ == "__main__":

    molecule = H2O
    # r = 0.995
    molecule_params = None

    # logging
    LogUtils.log_cofig()

    uccsd = UCCSD(molecule.n_orbitals, molecule.n_electrons)

    ansatz_elements = uccsd.get_ansatz_elements()

    vqe_runner = VQERunner(molecule, backend=QiskitSimulation, molecule_geometry_params=molecule_params,
                           print_var_parameters=True)
    t0 = time.time()
    result = vqe_runner.vqe_run(ansatz_elements=ansatz_elements, initial_var_parameters=initial_var_parameters)
    t = time.time()

    logging.critical(result)
    print(result)
    print('TIme for running: ', t - t0)

    print('Pizza')


